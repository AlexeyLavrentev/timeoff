{{> header }}

<h1>{{t "reportsLeaves.title"}}</h1>

<div class="row">
  <div class="col-md-6 lead">{{t "reportsLeaves.subtitle"}}</div>
</div>

{{> show_flash_messages }}

<ol class="breadcrumb">
  <li><a href="/reports/">{{t "reportsPage.allReports"}}</a></li>
  <li class="active">{{t "reportsLeaves.breadcrumbCurrent"}}</li>
</ol>
<div class="row main-row_header">
  <span class="col-md-12">{{t "reportsLeaves.filterTitle"}}</span>
</div>
<form action="" method="GET">
<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label>{{t "reportsLeaves.dateRangeLabel"}}</label>
              <div class="input-group">
                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                <input type="text" name="start_date" class="form-control" id="start_date" placeholder="{{t "reportsLeaves.fromDay"}}"
                  data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="1"
                  value="{{startDateStr}}"
                >
                <span class="input-group-addon">{{t "reports.dateFormatDayHint"}}</span>
                <span class="input-group-addon"><i class="fa fa-long-arrow-right"></i></span>
                <input type="text" name="end_date" class="form-control" id="end_date" placeholder="{{t "reportsLeaves.toDay"}}"
                  data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date-autoclose="1"
                  value="{{endDateStr}}"
                >
                <span class="input-group-addon">{{t "reports.dateFormatDayHint"}}</span>
              </div>
              <span class="help-block">{{t "reportsLeaves.dateRangeHelp"}}</span>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="department_id">{{t "requests.department"}}</label>
              <select class="form-control" id="department_id" name="department">
                <option>{{t "common.all"}}</option>
                {{#each departments}}
                <option value="{{this.id}}" {{#if_equal this.id ../departmentId}} selected="selected" {{/if_equal}}>{{this.name}}</option>
                {{/each}}
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="leave_type_id">{{t "reportsLeaves.leaveTypeLabel"}}</label>
              <select class="form-control" id="leave_type_id" name="leave_type">
                <option>{{t "common.all"}}</option>
                {{#each leaveTypes}}
                <option value="{{this.id}}" {{#if_equal this.id ../leaveTypeId}} selected="selected" {{/if_equal}}>{{this.name}}</option>
                {{/each}}
              </select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="form-group pull-right">
              <button class="btn btn-link" type="submit" name="as-csv" value="1"
                data-content="{{t "reportsLeaves.downloadCsvTooltip"}}"
                data-placement="top"
                data-toggle="popover"
                data-trigger="focus hover"
              ><i class="fa fa-download"></i> {{t "reports.csvSuffix"}}</button>
              <button class="btn btn-success single-click" type="submit">{{t "reportsLeaves.updateResults"}}</button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
<div class="row main-row_header">
  <span class="col-md-12">{{t "reportsLeaves.resultsTitle"}}</span>
</div>
<div class="row">
  {{#unless leaves}}
  <div class="col-md-12 text-muted">
    {{t "requests.noLeaveRequests"}}
  </div>
  {{else}}
  <div class="col-md-12">
    <p class="visible-xs-block"><em class="text-muted">{{t "requests.scrollTable"}}</em></p>
    <div class="table-responsive">
    <table class="table table-hover user-requests-table">
      <thead>
        <tr>
          <th class="col-xs-2">{{t "requests.employee"}} {{#if_equal sortBy 'employeeFullName'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="employeeFullName"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="col-xs-2">{{t "requests.department"}} {{#if_equal sortBy 'departmentName'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="departmentName"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="col-xs-1">{{t "requests.type"}} {{#if_equal sortBy 'type'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="type"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="_col-xs-1">{{t "requests.days"}}</th>
          <th class="col-xs-1">{{t "common.from"}} {{#if_equal sortBy 'startDate'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="startDate"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="col-xs-1">{{t "common.to"}} {{#if_equal sortBy 'endDate'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="endDate"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="col-xs-1">{{t "requests.status"}} {{#if_equal sortBy 'status'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="status"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="col-xs-1">{{t "reportsLeaves.added"}} {{#if_equal sortBy 'createdAt'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="createdAt"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="col-xs-2">{{t "reportsLeaves.approver"}} {{#if_equal sortBy 'approver'}}<i class="fa fa-sort-alpha-asc"></i>{{else}}<button class="btn btn-link btn-xs" name="sort_by" type="submit" value="approver"><i class="fa fa-sort-asc"></i></button>{{/if_equal}}</th>
          <th class="col-xs-2">{{t "requests.comment"}}</th>
        </tr>
      </thead>
      <tbody>
      {{#each leaves }}
        <tr class="leave-request-row">
          <td>{{ this.employeeFullName }}</td>
          <td>{{ this.departmentName}}</td>
          <td>{{ this.type }}</td>
          <td>{{ this.deductedDays }}</td>
          <td>{{as_date this.startDate }}</td>
          <td>{{as_date this.endDate}}</td>
          <td>{{ this.status }}</td>
          <td>{{as_date_from_timestamp this.createdAt}}</td>
          <td>{{ this.approver }}</td>
          <td>{{ this.comment }}</td>
        </tr>
      {{/each }}
      </tbody>
    </table>
    </div>
  </div>
  {{/unless}}
</div>
</form>

{{> footer }}
