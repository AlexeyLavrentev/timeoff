# TimeOff.Management

Веб‑приложение для управления отсутствиями сотрудников.

<a href="https://travis-ci.org/timeoff-management/timeoff-management-application"><img align="right" src="https://travis-ci.org/timeoff-management/timeoff-management-application.svg?branch=master" alt="Build status" /></a>

## Возможности

**Несколько представлений отсутствий**

Календарный вид, обзор команды или простой список.

**Гибкая настройка под политику компании**

Добавляйте собственные типы отсутствий: больничный, декрет, удалённая работа, день рождения и т.д. Определяйте, влияет ли тип на отпускной баланс.

Опционально ограничивайте количество дней, доступных для каждого типа отсутствия (например, не более 10 больничных в год).

Настраивайте государственные и корпоративные выходные.

Группируйте сотрудников по отделам, задавайте руководителя для каждого отдела.

Поддерживается индивидуальный рабочий график для компании и сотрудников.

**Интеграция с календарями**

Публикация отсутствий в MS Outlook, Google Calendar и iCal.

Создавайте фиды для сотрудников, отделов или всей компании.

**Трёхшаговый процесс согласования**

Сотрудник запрашивает отпуск или отзывает его.

Руководитель получает уведомление по почте и принимает решение.

Отсутствие учитывается, коллеги видят его в командном обзоре и календарях.

**Контроль доступа**

Есть роли: сотрудник, руководитель, администратор.

Поддерживается LDAP‑аутентификация.

**Экспорт данных**

Возможность выгрузки данных по отпускам в CSV для резервного копирования и работы в табличных редакторах.

**Работа на мобильных устройствах**

Основные сценарии оптимизированы для мобильных:

* запрос нового отпуска;
* согласование отпуска руководителем.

**Дополнительные улучшения**

* Интернационализация интерфейса (EN/RU) через i18next и шаблоны Handlebars.
* Группы пользователей с CRUD‑управлением и фильтрами в интерфейсе.
* Ограничение пересечения отпусков критически важных сотрудников по отделу.

## Скриншоты

![TimeOff.Management Screenshot](https://raw.githubusercontent.com/timeoff-management/application/master/public/img/readme_screenshot.png)

## Установка

### Облачный хостинг

Перейдите на http://timeoff.management/

Создайте аккаунт компании и используйте облачную версию.

### Самостоятельный хостинг

Убедитесь, что установлены Node.js (>=13.0.0) и SQLite.

```bash
git clone https://github.com/timeoff-management/application.git timeoff-management
cd timeoff-management
npm install
npm start
```

Откройте http://localhost:3000/ в браузере.

## Работа через Docker

### Сборка образа

```bash
docker build -t timeoff:local .
```

### Запуск контейнера

```bash
docker run --rm -p 3000:3000 timeoff:local
```

После запуска приложение будет доступно на http://localhost:3000/.

## Запуск тестов

Тесты покрывают основные пользовательские сценарии.

Убедитесь, что в системе установлен Chrome Driver и браузер Chrome.

Чтобы увидеть выполнение сценариев в браузере, задайте `SHOW_CHROME=1`.

```bash
USE_CHROME=1 npm test
```

(Приложение с настройками по умолчанию должно быть запущено.)

## Обновление существующей инсталляции

Если нужно обновить текущую установку новой версией:

```bash
git fetch
git pull origin master
npm install
npm run-script db-update
npm start
```

## Как настроить?

Есть несколько параметров для кастомизации.

### Язык интерфейса

По умолчанию используется язык из `config/app.json`:

* `default_language` — язык по умолчанию для интерфейса и писем (например, `en` или `ru`).
* `supported_languages` — список доступных языков (например, `["en", "ru"]`).

В интерфейсе доступен переключатель языка в правой части верхней панели. Он сохраняет выбор в cookie.

### Добавление нового языка

1. Создайте новый каталог перевода: `public/locales/<код_языка>/translation.json`.
2. Скопируйте структуру ключей из `public/locales/en/translation.json` и переведите значения.
3. Добавьте код языка в `supported_languages` и при необходимости укажите `default_language` в `config/app.json`.
4. Перезапустите приложение.

### Локализация сортировки

Если в компании есть сотрудники с именами на разных языках, может быть важно сортировать по соответствующему алфавиту.

Для этого в `config/app.json` есть параметр `locale_code_for_sorting`.
По умолчанию значение `en` (английский), но можно указать `cs`, `fr`, `de` и т.д.

### Принудительный выбор типа отпуска

Некоторые организации требуют, чтобы сотрудник каждый раз выбирал тип отсутствия при создании заявки, чтобы избежать «ошибочных» отпусков.

Для этого установите `is_force_to_explicitly_select_type_when_requesting_new_leave` в `true` в файле `config/app.json`.

## Использование Redis для сессий

Следуйте инструкциям на [этой странице](docs/SessionStoreInRedis.md).

## Обратная связь

Сообщайте об ошибках или оставляйте отзывы через <a href="https://twitter.com/FreeTimeOffApp">twitter</a> или по email: pavlo at timeoff.management
